# Global options
build -c opt \
      --incompatible_enable_cc_toolchain_resolution \
      --incompatible_require_linker_input_cc_api

# Aliases for user-defined flags
build --flag_alias=test_link_mode=@config//:test_link_mode
build --flag_alias=test_thread_mode=@config//:test_thread_mode
build --flag_alias=test_external_datasets=@config//:test_external_datasets
build --flag_alias=release_dpc=@config//:release_dpc
build --flag_alias=device=@config//:device
build --flag_alias=cpu=@config//:cpu

# Always pass this env variable to test rules, because SYCL
# OpenCL backend uses it to determine available devices
test --test_env=OCL_ICD_FILENAMES

# These variables enable double emulation on platforms
# that do not support it on hardware level
test --test_env=OverrideDefaultFP64Settings
test --test_env=IGC_ForceDPEmulation
test --test_env=IGC_EnableDPEmulation

# Configuration: 'host'
# Build & run all host tests
build:host \
    --build_tag_filters="host"

test:host \
    --test_tag_filters="host"


# Configuration: host-public
# Build & run all host tests for public interface
build:host-public \
    --build_tag_filters="host,-private"

test:host-public \
    --test_tag_filters="host,-private"


# Configuration: 'dpc'
# Build & run all DPC++ tests
build:dpc \
    --build_tag_filters="dpc"

test:dpc \
    --test_tag_filters="dpc"


# Configuration: 'dpc-public'
# Build & run all DPC++ tests for public interface
build:dpc-public \
    --build_tag_filters="dpc,-private"

test:dpc-public \
    --test_tag_filters="dpc,-private"
